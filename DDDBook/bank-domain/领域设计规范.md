### 领域设计规范

> 领域层设计是一个有挑战的任务，特别是在一个业务逻辑相对复杂应用中，每一个业务规则是应该放在 Entity、ValueObject 还是 DomainService 是值得用心思考的，既要避免未来的扩展性差，又要确保不会过度设计导致复杂性

> 继承虽然能 Open for extension，但很难做到 Closed for modification。所以今天解决 OCP 的主要方法是通过 Composition-over-inheritance，即通过组合来做到扩展性，而不是通过继承。


> 如果你的业务比较复杂，未来会有大量的业务规则变更时，简单的 OOP 代码会在后期变成复杂的一团浆糊，逻辑分散在各地，缺少全局视角，各种规则的叠加会触发 bug。
> 
> 有没有感觉似曾相识？对的，电商体系里的优惠、交易等链路经常会碰到类似的坑。
> 

> 而这类问题的核心本质在于：
* 业务规则的归属到底是对象的 “行为” 还是独立的 ”规则对象“？
* 业务规则之间的关系如何处理？
* 通用 “行为” 应该如何复用和维护？

#### Entity-Component-System（ECS）架构简介

> ECS 架构主要分为
* Entity：用来代表任何一个游戏对象，但是在 ECS 里一个 Entity 最重要的仅仅是他的 EntityID，一个 Entity 里包含多个 Component

* Component：是真正的数据，ECS 架构把一个个的实体对象拆分为更加细化的组件，比如位置、素材、状态等，也就是说一个 Entity 实际上只是一个 Bag of Components。

* System（或者 ComponentSystem，组件系统）：是真正的行为，一个游戏里可以有很多个不同的组件系统，每个组件系统都只负责一件事，可以依次处理大量的相同组件，而不需要去理解具体的 Entity。所以一个 ComponentSystem 理论上可以有更加高效的组件处理效率，甚至可以实现并行处理，从而提升 CPU 利用率。